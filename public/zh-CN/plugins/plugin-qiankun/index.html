<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="https://img.alicdn.com/tfs/TB1YHEpwUT1gK0jSZFhXXaAtVXa-28-27.svg"
    />
    <link rel="stylesheet" href="/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.5.26
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.includes(e) ? e : r[0]
        );
      })();
    </script>
    <title>@umijs/plugin-qiankun</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/zh-CN/plugins/plugin-qiankun" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" href="/zh-CN">UmiJS</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a href="/zh-CN/docs">文档</a></span><span><a href="/zh-CN/config">配置</a></span><span><a href="/zh-CN/api">API</a></span><span><a href="/zh-CN/guide">指南</a></span><span><a aria-current="page" class="active" href="/zh-CN/plugins">插件</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://v2.umijs.org">v2.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/umi">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><div class="__dumi-default-locale-select" data-locale-count="2"><a href="/plugins/plugin-qiankun">English</a></div><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" href="/zh-CN"></a><h1>UmiJS</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/zh-CN/docs">文档</a></li><li><a href="/zh-CN/config">配置</a></li><li><a href="/zh-CN/api">API</a></li><li><a href="/zh-CN/guide">指南</a></li><li><a aria-current="page" class="active" href="/zh-CN/plugins">插件</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://v2.umijs.org">v2.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/umi">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-locale-select" data-locale-count="2"><a href="/plugins/plugin-qiankun">English</a></div><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a target="_blank" rel="noopener noreferrer">Presets</a><ul><li><a href="/zh-CN/plugins/preset-react"><span>@umijs/preset-react</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">Plugins</a><ul><li><a href="/zh-CN/plugins/plugin-access"><span>@umijs/plugin-access</span></a></li><li><a href="/zh-CN/plugins/plugin-analytics"><span>@umijs/plugin-analytics</span></a></li><li><a href="/zh-CN/plugins/plugin-antd-mobile"><span>@umijs/plugin-antd-mobile</span></a></li><li><a href="/zh-CN/plugins/plugin-crossorigin"><span>@umijs/plugin-crossorigin</span></a></li><li><a href="/zh-CN/plugins/plugin-dva"><span>@umijs/plugin-dva</span></a></li><li><a href="/zh-CN/plugins/plugin-esbuild"><span>@umijs/plugin-esbuild</span></a></li><li><a href="/zh-CN/plugins/plugin-helmet"><span>@umijs/plugin-helmet</span></a></li><li><a href="/zh-CN/plugins/plugin-initial-state"><span>@umijs/plugin-initial-state</span></a></li><li><a href="/zh-CN/plugins/plugin-layout"><span>@umijs/plugin-layout</span></a></li><li><a href="/zh-CN/plugins/plugin-locale"><span>@umijs/plugin-locale</span></a></li><li><a href="/zh-CN/plugins/plugin-model"><span>@umijs/plugin-model</span></a></li><li><a href="/zh-CN/plugins/plugin-preact"><span>@umijs/plugin-preact</span></a></li><li><a aria-current="page" class="active" href="/zh-CN/plugins/plugin-qiankun"><span>@umijs/plugin-qiankun</span></a></li><li><a href="/zh-CN/plugins/plugin-request"><span>@umijs/plugin-request</span></a></li><li><a href="/zh-CN/plugins/plugin-sass"><span>@umijs/plugin-sass</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">插件开发</a><ul><li><a href="/zh-CN/plugins/api"><span>插件 API</span></a></li><li><a href="/zh-CN/plugins/best-practice"><span>插件开发最佳实践</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="启用方式" data-depth="2"><a href="/zh-CN/plugins/plugin-qiankun#启用方式"><span>启用方式</span></a></li><li title="介绍" data-depth="2"><a href="/zh-CN/plugins/plugin-qiankun#介绍"><span>介绍</span></a></li><li title="Examples" data-depth="2"><a href="/zh-CN/plugins/plugin-qiankun#examples"><span>Examples</span></a></li><li title="Features" data-depth="2"><a href="/zh-CN/plugins/plugin-qiankun#features"><span>Features</span></a></li><li title="Usage" data-depth="2"><a href="/zh-CN/plugins/plugin-qiankun#usage"><span>Usage</span></a></li><li title="主应用配置" data-depth="3"><a href="/zh-CN/plugins/plugin-qiankun#主应用配置"><span>主应用配置</span></a></li><li title="子应用配置" data-depth="3"><a href="/zh-CN/plugins/plugin-qiankun#子应用配置"><span>子应用配置</span></a></li><li title="父子应用通讯" data-depth="3"><a href="/zh-CN/plugins/plugin-qiankun#父子应用通讯"><span>父子应用通讯</span></a></li><li title="嵌套子应用" data-depth="3"><a href="/zh-CN/plugins/plugin-qiankun#嵌套子应用"><span>嵌套子应用</span></a></li><li title="API" data-depth="3"><a href="/zh-CN/plugins/plugin-qiankun#api"><span>API</span></a></li><li title="升级指南" data-depth="2"><a href="/zh-CN/plugins/plugin-qiankun#升级指南"><span>升级指南</span></a></li><li title="CHANGELOG" data-depth="2"><a href="/zh-CN/plugins/plugin-qiankun#changelog"><span>CHANGELOG</span></a></li><li title="与 @umijs/plugin-qiankun 2.3.0 之前版本的变化" data-depth="3"><a href="/zh-CN/plugins/plugin-qiankun#与-umijsplugin-qiankun-230-之前版本的变化"><span>与 @umijs/plugin-qiankun 2.3.0 之前版本的变化</span></a></li><li title="Roadmap" data-depth="2"><a href="/zh-CN/plugins/plugin-qiankun#roadmap"><span>Roadmap</span></a></li><li title="相关" data-depth="2"><a href="/zh-CN/plugins/plugin-qiankun#相关"><span>相关</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="umijsplugin-qiankun"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#umijsplugin-qiankun"><span class="icon icon-link"></span></a>@umijs/plugin-qiankun</h1><p>Umi plugin for <a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/qiankun">qiankun<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p><p><a target="_blank" rel="noopener noreferrer" href="https://npmjs.org/package/@umijs/plugin-qiankun"><img src="https://img.shields.io/npm/v/@umijs/plugin-qiankun.svg?style=flat" alt="NPM version"/></a> <a target="_blank" rel="noopener noreferrer" href="https://travis-ci.org/umijs/umi-plugin-qiankun"><img src="https://img.shields.io/travis/umijs/umi-plugin-qiankun.svg?style=flat" alt="Build Status"/></a> <a target="_blank" rel="noopener noreferrer" href="https://npmjs.org/package/@umijs/plugin-qiankun"><img src="http://img.shields.io/npm/dm/@umijs/plugin-qiankun.svg?style=flat" alt="NPM downloads"/></a></p><h2 id="启用方式"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#启用方式"><span class="icon icon-link"></span></a>启用方式</h2><ol><li><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">yarn</span><span class="token plain"> </span><span class="token function">add</span><span class="token plain"> @umijs/plugin-qiankun -D</span></div></pre></div></li><li><p>配置 <code>qiankun</code> 开启。</p></li></ol><h2 id="介绍"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#介绍"><span class="icon icon-link"></span></a>介绍</h2><p>Umi 应用一键开启 <a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/qiankun">qiankun<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 微前端模式。</p><h2 id="examples"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#examples"><span class="icon icon-link"></span></a>Examples</h2><p>导航是主应用，App1/App2 是子应用，App1/App2 也支持单独打开。主应用可以嵌套 APP1 和 APP2，App1 也可以嵌套 App2。</p><p><img src="https://gw.alipayobjects.com/mdn/rms_655822/afts/img/A*TroZSp_cH0MAAAAAAAAAAAAAARQnAQ" alt=""/></p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ </span><span class="token function">yarn</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ </span><span class="token function">yarn</span><span class="token plain"> build</span></div><div class="token-line"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> packages/plugin-qiankun </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token function">yarn</span><span class="token plain"> start</span></div></pre></div><h2 id="features"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#features"><span class="icon icon-link"></span></a>Features</h2><ul><li>✔︎ 基于 qiankun</li><li>✔︎ 支持主应用和子应用都用 umi</li><li>✔︎ 支持通过 <code>&lt;MicroApp /&gt;</code> 组件引入子应用</li><li>✔︎ 父子应用通讯</li><li>✔︎ 子应用运行时配置自定义 <code>bootstrap()</code>、<code>mount()</code> 和 <code>unmount()</code></li><li>✔︎ 主应用、子应用联调</li><li>✔︎ 嵌套子应用</li></ul><h2 id="usage"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#usage"><span class="icon icon-link"></span></a>Usage</h2><h3 id="主应用配置"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#主应用配置"><span class="icon icon-link"></span></a>主应用配置</h3><h4 id="第一步：注册子应用"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#第一步：注册子应用"><span class="icon icon-link"></span></a>第一步：注册子应用</h4><p>子应用注册有两种方式，<strong>二选一即可</strong></p><h5 id="a-插件构建期配置子应用"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#a-插件构建期配置子应用"><span class="icon icon-link"></span></a>a. 插件构建期配置子应用</h5><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  qiankun</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    master</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 注册子应用信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      apps</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;app1&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token comment">// 唯一 id</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          entry</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;//localhost:7001&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token comment">// html entry</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;app2&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token comment">// 唯一 id</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          entry</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;//localhost:7002&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token comment">// html entry</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h5 id="b-运行时动态配置子应用（srcappts-里开启）"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#b-运行时动态配置子应用（srcappts-里开启）"><span class="icon icon-link"></span></a>b. 运行时动态配置子应用（src/app.ts 里开启）</h5><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// 从接口中获取子应用配置，export 出的 qiankun 变量是一个 promise</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword">const</span><span class="token plain"> qiankun </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#x27;/config&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter punctuation">{</span><span class="token parameter"> apps </span><span class="token parameter punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 注册子应用信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  apps</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 完整生命周期钩子请看 https://qiankun.umijs.org/zh/api/#registermicroapps-apps-lifecycles</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  lifeCycles</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function-variable function">afterMount</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token plain">props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 支持更多的其他配置，详细看这里 https://qiankun.umijs.org/zh/api/#start-opts</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p>完整的主应用配置项看这里 <a href="/zh-CN/plugins/plugin-qiankun#masteroptions">masterOptions 配置列表</a></p><h4 id="第二步：装载子应用"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#第二步：装载子应用"><span class="icon icon-link"></span></a>第二步：装载子应用</h4><p>子应用的装载有两种方式，<strong>二选一即可：</strong></p><h5 id="a-使用路由绑定的方式"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#a-使用路由绑定的方式"><span class="icon icon-link"></span></a><a name="RouteBased">a. 使用路由绑定的方式</a></h5><div class="__dumi-default-alert" type="info">建议使用这种方式来引入自带路由的子应用。</div><p>假设我们的系统之前有这样的一些路由：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  routes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      component</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;../layouts/index.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      routes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/app1&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          component</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;./app1/index.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          routes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">              path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/app1/user&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">              component</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;./app1/user/index.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          component</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;./index.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><p>我们现在想在 <code>/app1/project</code> 和 <code>/app2</code> 这两个路径时分别加载微应用 app1 和 app2，只需要增加这样一些配置即可：</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">export default {</span></div><div class="token-line"><span class="token plain">	routes: [</span></div><div class="token-line"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     path: &#x27;/&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     component: &#x27;../layouts/index.js&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     routes: [</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         path: &#x27;/app1&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         component: &#x27;./app1/index.js&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         routes: [</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">           {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">             path: &#x27;/app1/user&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">             component: &#x27;./app1/user/index.js&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">           },</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">            // 配置微应用 app1 关联的路由</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">            {</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">              path: &#x27;/app1/project&#x27;,</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">              microApp: &#x27;app1&#x27;,</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">            },</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         ],</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       },</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">       // 配置 app2 关联的路由</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">       {</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">         path: &#x27;/app2&#x27;,</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">         microApp: &#x27;app2&#x27;</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">       },</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         path: &#x27;/&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         component: &#x27;./index.js&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       },</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     ],</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   },</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> ],</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token plain">}</span></div></pre></div><p>微应用路由也可以配置在运行时，通过 src/app.ts 添加：</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">const</span><span class="token plain"> qiankun </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#x27;/config&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> apps </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    apps</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    routes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/app1&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        microApp</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;app1&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p>运行时注册的路由会自动关联到你配置的根路由下面，比如你的路由是这样的：</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  routes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      component</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;../layouts/index.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      routes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/test&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          component</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;./test.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><p>完成了上面的运行时微应用路由配置后，你的路由结构会合自动并成这样的：</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">export default {</span></div><div class="token-line"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> routes: [</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     path: &#x27;/&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     component: &#x27;../layouts/index.js&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     routes: [</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">       {</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">         path: &#x27;/app1&#x27;,</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">         microApp: &#x27;app1&#x27;,</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">       },</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         path: &#x27;/test&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         component: &#x27;./test.js&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       },</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     ],</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   },</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> ]</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token plain">}</span></div></pre></div><h5 id="b-使用-microapp--组件的方式"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#b-使用-microapp--组件的方式"><span class="icon icon-link"></span></a>b. <a name="MicroApp">使用 <code>&lt;MicroApp /&gt;</code> 组件的方式</a></h5><div class="__dumi-default-alert" type="info">建议使用这种方式来引入不带路由的子应用。 否则请自行关注微应用依赖的路由跟当前浏览器 url 是否能正确匹配上，否则很容易出现微应用加载了，但是页面没有渲染出来的情况。</div><p>我们可以直接使用 React 标签的方式加载我们已注册过的子应用：</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">import { MicroApp } from &#x27;umi&#x27;;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">export function MyPage() {</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> return (</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   &lt;div&gt;</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     &lt;div&gt;</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">        &lt;MicroApp name=&quot;app1&quot; /&gt;</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     &lt;/div&gt;</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   &lt;/div&gt;</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> )</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token plain">}</span></div></pre></div><h5 id="loading-动画与组件样式"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#loading-动画与组件样式"><span class="icon icon-link"></span></a>loading 动画与组件样式</h5><p>你可以通过配置 <code>autoSetLoading</code> 的方式，开启微应用的 loading 动画。</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> MicroApp </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;umi&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">MyPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">MicroApp</span><span class="token tag"> </span><span class="token tag attr-name">name</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">app1</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">autoSetLoading</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><p>默认情况下，当我们检测到你使用的是 antd 组件库时，loading 动画使用的是 <a target="_blank" rel="noopener noreferrer" href="https://ant.design/components/spin-cn/">antd Spin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 组件。</p><p>如果你需要定制自己的 loading 动画，或者修改组件的样式，你可以这样处理：</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> MicroApp </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;umi&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">MyPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token operator">&lt;</span><span class="token plain">MicroApp</span></div><div class="token-line"><span class="token plain">        name</span><span class="token operator">=</span><span class="token string">&quot;app1&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        autoSetLoading</span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// 设置自定义 loading 动画</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        loader</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">loading</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain">loading</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain">loading</span><span class="token punctuation">}</span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// 微应用容器 class</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        className</span><span class="token operator">=</span><span class="token string">&quot;myContainer&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// wrapper class，仅开启 loading 动画时生效</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        wrapperClassName</span><span class="token operator">=</span><span class="token string">&quot;myWrapper&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><p>路由模式下，你可以这样设置一些静态配置开启 loading 动画：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/user&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  microApp</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;user&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  microAppProps</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    autoSetLoading</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    className</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;myContainer&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    wrapperClassName</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;myWrapper&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><p>或者，你可以通过设置 autoSetLoading false 来关闭自动的 loading 动画：</p><div class="__dumi-default-code-block"><pre class="prism-code language-tsx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token maybe-class-name">MicroApp</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;umi&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function maybe-class-name">MyPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token operator">&lt;</span><span class="token maybe-class-name">MicroApp</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          name</span><span class="token operator">=</span><span class="token string">&quot;app1&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token comment">// 关闭 loading 动画</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          autoSetLoading</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><h3 id="子应用配置"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#子应用配置"><span class="icon icon-link"></span></a>子应用配置</h3><h4 id="第一步：插件注册（configjs）"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#第一步：插件注册（configjs）"><span class="icon icon-link"></span></a>第一步：插件注册（config.js）</h4><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  qiankun</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    slave</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h4 id="第二步：配置运行时生命周期钩子（可选）"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#第二步：配置运行时生命周期钩子（可选）"><span class="icon icon-link"></span></a>第二步：配置运行时生命周期钩子（可选）</h4><p>插件会自动为你创建好 qiankun 子应用需要的生命周期钩子，但是如果你想在生命周期期间加一些自定义逻辑，可以在子应用的 <code>src/app.ts</code> 里导出 <code>qiankun</code> 对象，并实现每一个生命周期钩子，其中钩子函数的入参 <code>props</code> 由主应用自动注入。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword">const</span><span class="token plain"> qiankun </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 应用加载之前</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">async</span><span class="token plain"> </span><span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;app1 bootstrap&#x27;</span><span class="token punctuation">,</span><span class="token plain"> props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 应用 render 之前触发</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">async</span><span class="token plain"> </span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;app1 mount&#x27;</span><span class="token punctuation">,</span><span class="token plain"> props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 应用卸载之后触发</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">async</span><span class="token plain"> </span><span class="token function">unmount</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;app1 unmount&#x27;</span><span class="token punctuation">,</span><span class="token plain"> props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h4 id="环境变量配置"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#环境变量配置"><span class="icon icon-link"></span></a>环境变量配置</h4><p>为了获得更好地本地开发及调试体验，我们建议您提前在子应用中指定应用启动的具体端口号，如通过<code>.env</code>指定</p><div class="__dumi-default-code-block"><pre class="prism-code language-yml"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">PORT=8081</span></div></pre></div><p>详细配置参考：<a target="_blank" rel="noopener noreferrer" href="https://umijs.org/zh-CN/docs/env-variables#port">https://umijs.org/zh-CN/docs/env-variables#port<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="父子应用通讯"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#父子应用通讯"><span class="icon icon-link"></span></a>父子应用通讯</h3><p>有两种方式可以实现</p><h4 id="配合-usemodel-使用（推荐）"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#配合-usemodel-使用（推荐）"><span class="icon icon-link"></span></a>配合 <a target="_blank" rel="noopener noreferrer" href="https://umijs.org/zh-CN/plugins/plugin-model">useModel<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 使用（推荐）</h4><blockquote><p>需确保已安装 <code>@umijs/plugin-model</code> 或 <code>@umijs/preset-react</code></p></blockquote><ol><li><p>主应用使用下面任一方式透传数据：</p><ol><li><p>如果你用的 <a href="/zh-CN/plugins/plugin-qiankun#MicroApp">MicroApp</a> 组件模式消费微应用，那么数据传递的方式就跟普通的 react 组件通信是一样的，直接通过 props 传递即可：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">function</span><span class="token plain"> </span><span class="token function maybe-class-name">MyPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">name</span><span class="token punctuation">,</span><span class="token plain"> setName</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token operator">&lt;</span><span class="token maybe-class-name">MicroApp</span><span class="token plain"> name</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token plain">name</span><span class="token punctuation">}</span><span class="token plain"> onNameChange</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">newName</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token plain">newName</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div></li><li><p>如果你用的 <a href="/zh-CN/plugins/plugin-qiankun#RouteBased">路由绑定式</a> 消费微应用，那么你需要在 <code>src/app.ts</code> 里导出一个 <code>useQiankunStateForSlave</code> 函数，函数的返回值将作为 props 传递给微应用，如：</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// src/app.ts</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">useQiankunStateForSlave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">masterState</span><span class="token punctuation">,</span><span class="token plain"> setMasterState</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    masterState</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    setMasterState</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div></li></ol></li><li><p>微应用中会自动生成一个全局 model，可以在任意组件中获取主应用透传的 props 的值。</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> useModel </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;umi&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">MyPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> masterProps </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">useModel</span><span class="token punctuation">(</span><span class="token string">&#x27;@@qiankunStateFromMaster&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token punctuation">{</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token plain">masterProps</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><p>或者可以通过高阶组件 connectMaster 来获取主应用透传的 props</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> connectMaster </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;umi&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">MyPage</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token punctuation">{</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token plain">props</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token function">connectMaster</span><span class="token punctuation">(</span><span class="token plain">MyPage</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div></li><li><p>和 <code>&lt;MicroApp /&gt;</code> 的方式一同使用时，会额外向子应用传递一个 setLoading 的属性，在子应用中合适的时机执行 <code>masterProps.setLoading(false)</code>，可以标记微模块的整体 loading 为完成状态。</p></li></ol><h4 id="基于-props-传递"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#基于-props-传递"><span class="icon icon-link"></span></a>基于 props 传递</h4><p>类似 react 中组件间通信的方案</p><ol><li><p>主应用中配置 apps 时以 props 将数据传递下去（参考主应用运行时配置一节）</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// src/app.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword">const</span><span class="token plain"> qiankun </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#x27;/config&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    apps</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;app1&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        entry</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;//localhost:2222&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        props</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token function-variable function">onClick</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token plain">event</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;xx&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          age</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div></li><li><p>子应用在生命周期钩子中获取 props 消费数据（参考子应用运行时配置一节）</p></li></ol><h3 id="嵌套子应用"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#嵌套子应用"><span class="icon icon-link"></span></a>嵌套子应用</h3><p>除了导航应用之外，App1 与 App2 均依赖浏览器 url，为了让 App1 嵌套 App2，两个应用同时存在，我们需要在运行时将 App2 的路由改为 memory 类型。</p><ol><li>在 App1 中加入 master 配置</li></ol><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  qiankun</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    master</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 注册子应用信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      apps</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;app2&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token comment">// 唯一 id</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          entry</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;//localhost:7002&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token comment">// html entry</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><ol start="2"><li>通过 <code>&lt;MicroAppWithMemoHistory /&gt;</code> 引入 App2</li></ol><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">import { MicroAppWithMemoHistory } from &#x27;umi&#x27;;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">export function MyPage() {</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> return (</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   &lt;div&gt;</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     &lt;div&gt;</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted">+</span><span class="token inserted-sign inserted line">        &lt;MicroAppWithMemoHistory name=&quot;app2&quot; url=&quot;/user&quot; /&gt;</span></div><div class="token-line"><span class="token inserted-sign inserted line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     &lt;/div&gt;</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   &lt;/div&gt;</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> )</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token plain">}</span></div></pre></div><h3 id="api"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#api"><span class="icon icon-link"></span></a>API</h3><h4 id="masteroptions"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#masteroptions"><span class="icon icon-link"></span></a>MasterOptions</h4><table><thead><tr><th>配置</th><th>说明</th><th>类型</th><th>是否必填</th><th>默认值</th></tr></thead><tbody><tr><td>apps</td><td>子应用配置</td><td><a href="/zh-CN/plugins/plugin-qiankun#app">App</a>[]</td><td>是</td><td></td></tr><tr><td>routes</td><td>子应用运行时需要注册的微应用路由</td><td><a href="/zh-CN/plugins/plugin-qiankun#route">Route</a>[]</td><td>否</td><td>N/A</td></tr><tr><td>sandbox</td><td>是否启用沙箱，<a target="_blank" rel="noopener noreferrer" href="https://qiankun.umijs.org/zh/api/#start-opts">详细说明<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>boolean</td><td>否</td><td>true</td></tr><tr><td>prefetch</td><td>是否启用 prefetch 特性，<a target="_blank" rel="noopener noreferrer" href="https://qiankun.umijs.org/zh/api/#start-opts">详细说明<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>boolean | &#x27;all&#x27;</td><td>否</td><td>true</td></tr></tbody></table><h4 id="app"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#app"><span class="icon icon-link"></span></a>App</h4><table><thead><tr><th>配置</th><th>说明</th><th>类型</th><th>是否必填</th><th>默认值</th></tr></thead><tbody><tr><td>name</td><td>子应用唯一 id</td><td>string</td><td>是</td><td></td></tr><tr><td>entry</td><td>子应用 html 地址</td><td>string | <!-- -->{<!-- --> script: string[], styles: [] <!-- -->}</td><td>是</td><td></td></tr><tr><td>credentials</td><td>拉取 entry 时是否需要携带cookie，<a target="_blank" rel="noopener noreferrer" href="https://qiankun.umijs.org/zh/faq#%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E6%8B%89%E5%8F%96%E5%BE%AE%E5%BA%94%E7%94%A8-entry-%E6%97%B6-cookie-%E6%9C%AA%E6%90%BA%E5%B8%A6%E7%9A%84%E9%97%AE%E9%A2%98">详见<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td><td>boolean</td><td>否</td><td>false</td></tr><tr><td>props</td><td>主应用传递给子应用的数据</td><td>object</td><td>否</td><td>{<!-- -->}</td></tr></tbody></table><h4 id="route"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#route"><span class="icon icon-link"></span></a>Route</h4><table><thead><tr><th>配置</th><th>说明</th><th>类型</th><th>是否必填</th><th>默认值</th></tr></thead><tbody><tr><td>path</td><td>路由 path</td><td>string</td><td>是</td><td></td></tr><tr><td>microApp</td><td>关联的微应用名称</td><td>string</td><td>是</td><td></td></tr><tr><td>microAppProps</td><td>微应用配置</td><td>{<!-- -->autoSetLoading: boolean, className: string, wrapperClassName: string<!-- -->}</td><td>否</td><td>{<!-- -->}</td></tr></tbody></table><h2 id="升级指南"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#升级指南"><span class="icon icon-link"></span></a>升级指南</h2><p>v2.3.0 完全兼容 v2 之前的版本，但我们还是建议您能升级到最新版本已获得更好的开发体验。</p><ol><li><p>移除无必要的应用配置</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">export default {</span></div><div class="token-line"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> qiankun: {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   master: {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     apps: [</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         name: &#x27;microApp&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">         entry: &#x27;//umi.dev.cnd/entry.html&#x27;,</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">         base: &#x27;/microApp&#x27;,</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">         mountElementId: &#x27;root-subapp&#x27;,</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">         history: &#x27;browser&#x27;,</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       }</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     ]</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   }</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> }</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token plain">}</span></div></pre></div></li><li><p>移除无必要的全局配置</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">export default {</span></div><div class="token-line"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> qiankun: {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   master: {</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">     apps: [],</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">     defer: true,</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   }</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> }</span></div><div class="token-line"><span class="token unchanged line"></span><span class="token plain">}</span></div></pre></div></li><li><p>移除不必要的挂载容器</p><div class="__dumi-default-code-block"><pre class="prism-code language-diff"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">export default MyContainer() {</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">  return (</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">    &lt;div&gt;</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">      &lt;div id=&quot;root-subapp&quot;&gt;&lt;/div&gt;</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">    &lt;/div&gt;</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">  )</span></div><div class="token-line"><span class="token deleted-sign deleted line"></span><span class="token deleted-sign deleted prefix deleted">-</span><span class="token deleted-sign deleted line">}</span></div></pre></div></li><li><p>关联微应用</p><p>比如我们之前配置了一个微应用名为 <code>microApp</code> ，base 为 <code>/microApp</code> ，mountElementId 为 <code>subapp-container</code>， 那么我们只需要（二选一）：</p><p>a. 增加 <code>/microApp</code> 的路由（推荐）</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  routes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token operator">...</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token plain"> path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/microApp&#x27;</span><span class="token punctuation">,</span><span class="token plain"> microApp</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;microApp&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><p><strong>使用路由关联模式时，不再需要微应用的 base 配置必须跟主应用中的保持一致了。</strong></p><p>b. 在 <code>/microApp</code> 路由对应的组件里使用 <code>MicroApp</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  routes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token operator">...</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token plain"> path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;/microApp&#x27;</span><span class="token punctuation">,</span><span class="token plain"> component</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;MyPage&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> MicroApp </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;umi&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token function">MyPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">MicroApp</span><span class="token tag"> </span><span class="token tag attr-name">name</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">microApp</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">base</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">/microApp</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div></li><li><p>移除一些无效配置，如 <a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/umi-plugin-qiankun#1-%E4%B8%BB%E5%BA%94%E7%94%A8%E6%96%B0%E5%BB%BA-pagessubappcontainerjs">手动添加子应用路由配置<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ol><h2 id="changelog"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#changelog"><span class="icon icon-link"></span></a>CHANGELOG</h2><h3 id="与-umijsplugin-qiankun-230-之前版本的变化"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#与-umijsplugin-qiankun-230-之前版本的变化"><span class="icon icon-link"></span></a>与 @umijs/plugin-qiankun 2.3.0 之前版本的变化</h3><ul><li><p>主应用注册子应用时不再需要手动配置 base 和 mountElementId。</p><p>这类方式会导致很多关联问题，最典型的是如果我们需要将子应用挂载到某一个具体的子路由下时，常出现由于挂载点还未初始化或已被销毁导致的问题。</p><p>现在只需要在注册完子应用后，在期望的路由下指定需要挂载的子应用的 name 即可。</p></li><li><p>可以直接通过 <code>&lt;MicroApp /&gt;</code> 组件的方式在任意位置挂载自己的子应用。详见 <a href="/zh-CN/plugins/plugin-qiankun#MicroApp">API 说明</a></p></li><li><p>不再支持主应用是 browser 路由模式，子应用是 hash 路由的混合模式。如果有场景需要可以通过自己使用 <code>&lt;MicroApp /&gt;</code>组件加载子应用。</p></li><li><p>移除了 base、mountElementId、defer 等配置，现在有更好的方式来解决这类问题，参见第一条。</p></li><li><p>rename <code>jsSandbox</code> -&gt; <code>sandbox</code>，来自 qiankun2.0 的升级。</p></li><li><p><strong>完全兼容 1.x 插件。</strong></p></li></ul><h2 id="roadmap"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#roadmap"><span class="icon icon-link"></span></a>Roadmap</h2><ul class="contains-task-list"><li class="task-list-item"><p><input type="checkbox" disabled="" checked=""/> 动态 history type 支持（即将到来 🎉），依赖 umi: ^3.2.7, @umijs/plugin-qiankun: ^2.4.0</p><p>通过运行时设置微应用 props 的方式，修改微应用 history 相关配置，从而解耦微应用配置，如：</p><div class="__dumi-default-code-block"><pre class="prism-code language-tsx"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// HistoryOptions 配置见 https://github.com/ReactTraining/history/blob/master/docs/api-reference.md</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">HistoryProp</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token keyword">type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;browser&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&#x27;memory&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&#x27;hash&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain"> </span><span class="token maybe-class-name">HistoryOptions</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">MicroApp</span><span class="token tag"> </span><span class="token tag attr-name">history</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript keyword">type</span><span class="token tag script language-javascript operator">:</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript string">&#x27;browser&#x27;</span><span class="token tag script language-javascript punctuation">,</span><span class="token tag script language-javascript"> basename</span><span class="token tag script language-javascript operator">:</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript string">&#x27;/microApp&#x27;</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript punctuation">}</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span></div></pre></div></li><li class="task-list-item"><p><input type="checkbox" disabled=""/> 运行时统一，针对多层嵌套微应用场景</p></li><li class="task-list-item"><p><input type="checkbox" disabled="" checked=""/> 微应用自动 mountElementId，避免多个 umi 子应用 mountElementId 冲突</p></li><li class="task-list-item"><p><input type="checkbox" disabled="" checked=""/> 自动 loading</p></li><li class="task-list-item"><p><input type="checkbox" disabled=""/> 本地集成开发支持</p></li></ul><h2 id="相关"><a aria-hidden="true" tabindex="-1" href="/zh-CN/plugins/plugin-qiankun#相关"><span class="icon icon-link"></span></a>相关</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/plugins/issues/64">https://github.com/umijs/plugins/issues/64<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/umi/edit/master/docs/plugins/plugin-qiankun.zh-CN.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">4/29/2021 11:55:41</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/umi.js"></script>
  </body>
</html>
